<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width$.<span class="function">ajax</span>({
    uaxios.<span class="function">post</span>(<span class="<span class="keyword">var</span> data = JSON.<span class="functio        function getPaymentData() {
            return {
                merchantId: '103881636900016',
                amount: 0.01,
                orderNo: 'TEST' + Date.now(),
                orderDesc: 'æµ‹è¯•è®¢å•-PaymentType=A',
                payTypeID: 'PreAuthPay',
                notifyUrl: 'https://payment.qsgl.net/api/payment/abc/notify',
                merchantSuccessUrl: 'https://payment.qsgl.net/payment/success',
                merchantErrorUrl: 'https://payment.qsgl.net/payment/error'
            };
        }y</span>({
    merchantId: <span class="string">'103881636900016'</span>,
    amount: <span class="number">0.01</span>,
    orderNo: <span class="string">'TEST'</span> + Date.<span class="function">now</span>(),
    orderDesc: <span class="string">'æµ‹è¯•è®¢å•-PaymentType=A'</span>,
    payTypeID: <span class="string">'ImmediatePay'</span>,
    notifyUrl: <span class="string">'https://payment.qsgl.net/api/payment/abc/notify'</span>
});>'https://payment.qsgl.net/api/payment/abc/pagepay'</span>, {
    merchantId: <span class="string">'103881636900016'</span>,
    amount: <span class="number">0.01</span>,
    orderNo: <span class="string">'TEST'</span> + Date.<span class="function">now</span>(),
    orderDesc: <span class="string">'æµ‹è¯•è®¢å•-PaymentType=A'</span>,
    payTypeID: <span class="string">'PreAuthPay'</span>,
    notifyUrl: <span class="string">'https://payment.qsgl.net/api/payment/abc/notify'</span>,
    merchantSuccessUrl: <span class="string">'https://payment.qsgl.net/payment/success'</span>,
    merchantErrorUrl: <span class="string">'https://payment.qsgl.net/payment/error'</span>
}) class="string">'https://payment.qsgl.net/api/payment/abc/pagepay'</span>,
    type: <span class="string">'POST'</span>,
    contentType: <span class="string">'application/json'</span>,
    data: JSON.<span class="function">stringify</span>({
        merchantId: <span class="string">'103881636900016'</span>,
        amount: <span class="number">0.01</span>,
        orderNo: <span class="string">'TEST'</span> + Date.<span class="function">now</span>(),
        orderDesc: <span class="string">'æµ‹è¯•è®¢å•-PaymentType=A'</span>,
        payTypeID: <span class="string">'PreAuthPay'</span>,
        notifyUrl: <span class="string">'https://payment.qsgl.net/api/payment/abc/notify'</span>,
        merchantSuccessUrl: <span class="string">'https://payment.qsgl.net/payment/success'</span>,
        merchantErrorUrl: <span class="string">'https://payment.qsgl.net/payment/error'</span>
    }),, initial-scale=1.0">
    <title>å†œè¡Œæ”¯ä»˜ - AJAXè°ƒç”¨ç¤ºä¾‹</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .code-section {
            background: #fff;
            padding: 30px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h2 {
            color: #333;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        pre {
            background: #282c34;
            color: #abb2bf;
            padding: 20px;
            border-radius: 6px;
            overflow-x: auto;
            font-size: 14px;
            line-height: 1.5;
        }
        .keyword { color: #c678dd; }
        .string { color: #98c379; }
        .function { color: #61afef; }
        .comment { color: #5c6370; font-style: italic; }
        .number { color: #d19a66; }
        .btn-test {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        .btn-test:hover {
            background: #5568d3;
        }
        #testResult {
            margin-top: 20px;
            padding: 15px;
            border-radius: 6px;
            display: none;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <h1>ğŸ¦ å†œè¡Œæ”¯ä»˜æ¥å£è°ƒç”¨ç¤ºä¾‹</h1>
    
    <!-- æ–¹æ³•ä¸€: åŸç”Ÿ Fetch API -->
    <div class="code-section">
        <h2>æ–¹æ³•ä¸€: ä½¿ç”¨ Fetch API (æ¨è)</h2>
        <pre><code><span class="comment">// 1. é…ç½®æ¥å£åœ°å€</span>
<span class="keyword">const</span> API_URL = <span class="string">'https://payment.qsgl.net/api/payment/abc/pagepay'</span>;

<span class="comment">// 2. å‡†å¤‡æ”¯ä»˜æ•°æ®</span>
<span class="keyword">const</span> paymentData = {
    merchantId: <span class="string">'103881636900016'</span>,           <span class="comment">// å•†æˆ·å·</span>
    amount: <span class="number">0.01</span>,                            <span class="comment">// æ”¯ä»˜é‡‘é¢(å…ƒ)</span>
    orderNo: <span class="string">'TEST'</span> + Date.<span class="function">now</span>(),          <span class="comment">// è®¢å•å·(å”¯ä¸€)</span>
    orderDesc: <span class="string">'æµ‹è¯•è®¢å•-PaymentType=A'</span>,     <span class="comment">// è®¢å•æè¿°</span>
    payTypeID: <span class="string">'PreAuthPay'</span>,                 <span class="comment">// äº¤æ˜“ç±»å‹: ImmediatePay/DividedPay/PreAuthPay</span>
    notifyUrl: <span class="string">'https://payment.qsgl.net/api/payment/abc/notify'</span>,  <span class="comment">// å›è°ƒåœ°å€</span>
    merchantSuccessUrl: <span class="string">'https://payment.qsgl.net/payment/success'</span>, <span class="comment">// æˆåŠŸè·³è½¬(å¯é€‰)</span>
    merchantErrorUrl: <span class="string">'https://payment.qsgl.net/payment/error'</span>      <span class="comment">// å¤±è´¥è·³è½¬(å¯é€‰)</span>
};

<span class="comment">// 3. å‘é€æ”¯ä»˜è¯·æ±‚</span>
<span class="keyword">async function</span> <span class="function">createPayment</span>() {
    <span class="keyword">try</span> {
        <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="function">fetch</span>(API_URL, {
            method: <span class="string">'POST'</span>,
            headers: {
                <span class="string">'Content-Type'</span>: <span class="string">'application/json'</span>
            },
            body: JSON.<span class="function">stringify</span>(paymentData)
        });

        <span class="keyword">const</span> result = <span class="keyword">await</span> response.<span class="function">json</span>();
        
        <span class="keyword">if</span> (result.isSuccess && result.paymentURL) {
            <span class="comment">// è·³è½¬åˆ°å†œè¡Œæ”¯ä»˜é¡µé¢</span>
            window.location.href = result.paymentURL;
        } <span class="keyword">else</span> {
            console.<span class="function">error</span>(<span class="string">'æ”¯ä»˜å¤±è´¥:'</span>, result.message);
        }
    } <span class="keyword">catch</span> (error) {
        console.<span class="function">error</span>(<span class="string">'è¯·æ±‚å¼‚å¸¸:'</span>, error);
    }
}</code></pre>
        <button class="btn-test" onclick="testFetch()">ğŸš€ æµ‹è¯• Fetch è°ƒç”¨</button>
    </div>

    <!-- æ–¹æ³•äºŒ: jQuery Ajax -->
    <div class="code-section">
        <h2>æ–¹æ³•äºŒ: ä½¿ç”¨ jQuery.ajax</h2>
        <pre><code><span class="comment">// éœ€è¦å…ˆå¼•å…¥ jQuery: &lt;script src="https://code.jquery.com/jquery-3.6.0.min.js"&gt;&lt;/script&gt;</span>

$.<span class="function">ajax</span>({
    url: <span class="string">'https://payment.qsgl.net/api/payment/abc/pagepay'</span>,
    type: <span class="string">'POST'</span>,
    contentType: <span class="string">'application/json'</span>,
    data: JSON.<span class="function">stringify</span>({
        merchantId: <span class="string">'103881636900016'</span>,
        amount: <span class="number">0.01</span>,
        orderNo: <span class="string">'TEST'</span> + Date.<span class="function">now</span>(),
        orderDesc: <span class="string">'æµ‹è¯•è®¢å•-PaymentType=A'</span>,
        payTypeID: <span class="string">'PreAuthPay'</span>,
        notifyUrl: <span class="string">'https://payment.qsgl.net/api/payment/abc/notify'</span>,
        merchantSuccessUrl: <span class="string">'https://payment.qsgl.net/payment/success'</span>,
        merchantErrorUrl: <span class="string">'https://payment.qsgl.net/payment/error'</span>
    }),
    <span class="function">success</span>: <span class="keyword">function</span>(result) {
        <span class="keyword">if</span> (result.isSuccess && result.paymentURL) {
            window.location.href = result.paymentURL;
        } <span class="keyword">else</span> {
            <span class="function">alert</span>(<span class="string">'æ”¯ä»˜å¤±è´¥: '</span> + result.message);
        }
    },
    <span class="function">error</span>: <span class="keyword">function</span>(xhr, status, error) {
        console.<span class="function">error</span>(<span class="string">'è¯·æ±‚å¤±è´¥:'</span>, error);
    }
});</code></pre>
        <button class="btn-test" onclick="testJQuery()">ğŸš€ æµ‹è¯• jQuery è°ƒç”¨</button>
    </div>

    <!-- æ–¹æ³•ä¸‰: Axios -->
    <div class="code-section">
        <h2>æ–¹æ³•ä¸‰: ä½¿ç”¨ Axios</h2>
        <pre><code><span class="comment">// éœ€è¦å…ˆå¼•å…¥ Axios: &lt;script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"&gt;&lt;/script&gt;</span>

axios.<span class="function">post</span>(<span class="string">'https://payment.qsgl.net/api/payment/abc/pagepay'</span>, {
    merchantId: <span class="string">'103881636900016'</span>,
    amount: <span class="number">0.01</span>,
    orderNo: <span class="string">'TEST'</span> + Date.<span class="function">now</span>(),
    orderDesc: <span class="string">'æµ‹è¯•è®¢å•-PaymentType=1'</span>,
    notifyUrl: <span class="string">'https://payment.qsgl.net/api/payment/abc/notify'</span>,
    merchantSuccessUrl: <span class="string">'https://payment.qsgl.net/payment/success'</span>,
    merchantErrorUrl: <span class="string">'https://payment.qsgl.net/payment/error'</span>
})
.<span class="function">then</span>(<span class="keyword">function</span>(response) {
    <span class="keyword">const</span> result = response.data;
    <span class="keyword">if</span> (result.isSuccess && result.paymentURL) {
        window.location.href = result.paymentURL;
    } <span class="keyword">else</span> {
        console.<span class="function">error</span>(<span class="string">'æ”¯ä»˜å¤±è´¥:'</span>, result.message);
    }
})
.<span class="function">catch</span>(<span class="keyword">function</span>(error) {
    console.<span class="function">error</span>(<span class="string">'è¯·æ±‚å¼‚å¸¸:'</span>, error);
});</code></pre>
        <button class="btn-test" onclick="testAxios()">ğŸš€ æµ‹è¯• Axios è°ƒç”¨</button>
    </div>

    <!-- æ–¹æ³•å››: åŸç”Ÿ XMLHttpRequest -->
    <div class="code-section">
        <h2>æ–¹æ³•å››: ä½¿ç”¨ XMLHttpRequest (å…¼å®¹æ—§æµè§ˆå™¨)</h2>
        <pre><code><span class="keyword">var</span> xhr = <span class="keyword">new</span> <span class="function">XMLHttpRequest</span>();
xhr.<span class="function">open</span>(<span class="string">'POST'</span>, <span class="string">'https://payment.qsgl.net/api/payment/abc/pagepay'</span>, <span class="keyword">true</span>);
xhr.<span class="function">setRequestHeader</span>(<span class="string">'Content-Type'</span>, <span class="string">'application/json'</span>);

xhr.<span class="function">onreadystatechange</span> = <span class="keyword">function</span>() {
    <span class="keyword">if</span> (xhr.readyState === <span class="number">4</span>) {
        <span class="keyword">if</span> (xhr.status === <span class="number">200</span>) {
            <span class="keyword">var</span> result = JSON.<span class="function">parse</span>(xhr.responseText);
            <span class="keyword">if</span> (result.isSuccess && result.paymentURL) {
                window.location.href = result.paymentURL;
            } <span class="keyword">else</span> {
                console.<span class="function">error</span>(<span class="string">'æ”¯ä»˜å¤±è´¥:'</span>, result.message);
            }
        } <span class="keyword">else</span> {
            console.<span class="function">error</span>(<span class="string">'è¯·æ±‚å¤±è´¥:'</span>, xhr.status);
        }
    }
};

<span class="keyword">var</span> data = JSON.<span class="function">stringify</span>({
    merchantId: <span class="string">'103881636900016'</span>,
    amount: <span class="number">0.01</span>,
    orderNo: <span class="string">'TEST'</span> + Date.<span class="function">now</span>(),
    orderDesc: <span class="string">'æµ‹è¯•è®¢å•-PaymentType=1'</span>,
    notifyUrl: <span class="string">'https://payment.qsgl.net/api/payment/abc/notify'</span>
});

xhr.<span class="function">send</span>(data);</code></pre>
        <button class="btn-test" onclick="testXHR()">ğŸš€ æµ‹è¯• XHR è°ƒç”¨</button>
    </div>

    <!-- å“åº”æ ¼å¼è¯´æ˜ -->
    <div class="code-section">
        <h2>ğŸ“„ å“åº”æ•°æ®æ ¼å¼</h2>
        <pre><code><span class="comment">// æˆåŠŸå“åº”ç¤ºä¾‹</span>
{
    <span class="string">"isSuccess"</span>: <span class="keyword">true</span>,
    <span class="string">"orderNo"</span>: <span class="string">"TEST1737523456789"</span>,
    <span class="string">"paymentURL"</span>: <span class="string">"https://pay.abchina.com/EbusPerbankFront/PaymentModeNewAct?TOKEN=..."</span>,
    <span class="string">"status"</span>: <span class="string">"SUCCESS"</span>,
    <span class="string">"message"</span>: <span class="string">"äº¤æ˜“æˆåŠŸ"</span>,
    <span class="string">"errorCode"</span>: <span class="string">"0000"</span>
}

<span class="comment">// å¤±è´¥å“åº”ç¤ºä¾‹</span>
{
    <span class="string">"isSuccess"</span>: <span class="keyword">false</span>,
    <span class="string">"orderNo"</span>: <span class="string">"TEST1737523456789"</span>,
    <span class="string">"paymentURL"</span>: <span class="keyword">null</span>,
    <span class="string">"status"</span>: <span class="string">"FAILED"</span>,
    <span class="string">"message"</span>: <span class="string">"é‡‘é¢æ ¼å¼é”™è¯¯"</span>,
    <span class="string">"errorCode"</span>: <span class="string">"9998"</span>
}</code></pre>
    </div>

    <!-- æµ‹è¯•ç»“æœæ˜¾ç¤ºåŒºåŸŸ -->
    <div id="testResult"></div>

    <!-- å¼•å…¥ jQuery å’Œ Axios -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <script>
        const API_URL = 'https://payment.qsgl.net/api/payment/abc/pagepay';

        function showResult(success, message, data) {
            const resultDiv = document.getElementById('testResult');
            resultDiv.className = success ? 'success' : 'error';
            resultDiv.innerHTML = `
                <h3>${success ? 'âœ… æˆåŠŸ' : 'âŒ å¤±è´¥'}</h3>
                <p>${message}</p>
                <pre>${JSON.stringify(data, null, 2)}</pre>
            `;
            resultDiv.style.display = 'block';
            resultDiv.scrollIntoView({ behavior: 'smooth' });
        }

        function getPaymentData() {
            return {
                merchantId: '103881636900016',
                amount: 0.01,
                orderNo: 'TEST' + Date.now(),
                orderDesc: 'æµ‹è¯•è®¢å•-PaymentType=1',
                notifyUrl: 'https://payment.qsgl.net/api/payment/abc/notify',
                merchantSuccessUrl: 'https://payment.qsgl.net/payment/success',
                merchantErrorUrl: 'https://payment.qsgl.net/payment/error'
            };
        }

        // æµ‹è¯• Fetch
        async function testFetch() {
            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(getPaymentData())
                });
                const result = await response.json();
                
                if (result.isSuccess && result.paymentURL) {
                    showResult(true, 'æ”¯ä»˜é“¾æ¥å·²ç”Ÿæˆ,3ç§’åè·³è½¬...', result);
                    setTimeout(() => window.location.href = result.paymentURL, 3000);
                } else {
                    showResult(false, result.message, result);
                }
            } catch (error) {
                showResult(false, 'è¯·æ±‚å¼‚å¸¸: ' + error.message, error);
            }
        }

        // æµ‹è¯• jQuery
        function testJQuery() {
            $.ajax({
                url: API_URL,
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify(getPaymentData()),
                success: function(result) {
                    if (result.isSuccess && result.paymentURL) {
                        showResult(true, 'æ”¯ä»˜é“¾æ¥å·²ç”Ÿæˆ,3ç§’åè·³è½¬...', result);
                        setTimeout(() => window.location.href = result.paymentURL, 3000);
                    } else {
                        showResult(false, result.message, result);
                    }
                },
                error: function(xhr, status, error) {
                    showResult(false, 'è¯·æ±‚å¤±è´¥: ' + error, { status, error });
                }
            });
        }

        // æµ‹è¯• Axios
        function testAxios() {
            axios.post(API_URL, getPaymentData())
                .then(function(response) {
                    const result = response.data;
                    if (result.isSuccess && result.paymentURL) {
                        showResult(true, 'æ”¯ä»˜é“¾æ¥å·²ç”Ÿæˆ,3ç§’åè·³è½¬...', result);
                        setTimeout(() => window.location.href = result.paymentURL, 3000);
                    } else {
                        showResult(false, result.message, result);
                    }
                })
                .catch(function(error) {
                    showResult(false, 'è¯·æ±‚å¼‚å¸¸: ' + error.message, error);
                });
        }

        // æµ‹è¯• XHR
        function testXHR() {
            var xhr = new XMLHttpRequest();
            xhr.open('POST', API_URL, true);
            xhr.setRequestHeader('Content-Type', 'application/json');
            
            xhr.onreadystatechange = function() {
                if (xhr.readyState === 4) {
                    if (xhr.status === 200) {
                        var result = JSON.parse(xhr.responseText);
                        if (result.isSuccess && result.paymentURL) {
                            showResult(true, 'æ”¯ä»˜é“¾æ¥å·²ç”Ÿæˆ,3ç§’åè·³è½¬...', result);
                            setTimeout(() => window.location.href = result.paymentURL, 3000);
                        } else {
                            showResult(false, result.message, result);
                        }
                    } else {
                        showResult(false, 'è¯·æ±‚å¤±è´¥: HTTP ' + xhr.status, { status: xhr.status });
                    }
                }
            };
            
            xhr.send(JSON.stringify(getPaymentData()));
        }
    </script>
</body>
</html>
